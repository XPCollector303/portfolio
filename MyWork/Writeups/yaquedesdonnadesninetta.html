<!DOCTYPE html>
<html>
    <head>
        <title>Sam's portfolio</title>
        <link rel="stylesheet" href="../../styles.css" />
    </head>
    <body>
        <a href="https://cyberdefenders.org/blueteam-ctf-challenges/reveal/">See the lab</a>
        <a href src="../../index.html">See my portfolio :D</a>
        <div class="text">
            <p>Ceci est un writeup du lab Reveal, entièrement en français. Il consiste en l'analyse d'un dump mémoire à l'aide de Volatility 3.</p>
            <strong>Question 1 : Identifying the name of the malicious process helps in understanding the nature of the attack. What is the name of the malicious process?</strong>
            <p>Pour cette première question, il faut utiliser la commande windows.pstree de Volatility 3. On peut non seulement voir les processus, mais aussi leurs processus enfants, et la ligne de commande lancée pour les exécuter.</p>
            <p>Dans le cas de Powershell.exe, on a une ligne de commande assez suspecte : elle lance rundll32.exe (pour lancer un fichier .dll), qui provient d'un serveur extérieur au réseau de la machine.</p>
            <img src="Capture d'écran 2025-10-26 185200.png">
            <strong> Réponse : Powershell.exe</strong>
            <hr>
            <strong>Question 2 : Knowing the parent process ID (PPID) of the malicious process aids in tracing the process hierarchy and understanding the attack flow. What is the parent PID of the malicious process?</strong>
            <p>Il suffit de regarder dans le résultat de windows.pstree, au niveau de l'entrée sur Powershell.</p>
            <img src="Capture d'écran 2025-10-26 185545.png">
            <strong>Réponse : 4120</strong>
            <hr>
            <strong>Question 3 : Determining the file name used by the malware for executing the second-stage payload is crucial for identifying subsequent malicious activities. What is the file name that the malware uses to execute the second-stage payload?</strong>
            <p>Encore une fois, il faut juste regarder l'entrée de Powershell, dans les arguments de la ligne de commande.</p>
            <img src="Capture d'écran 2025-10-26 190140.png">
            <strong>Réponse : 3435.dll</strong>
            <hr>
            <strong>Question 4 : Identifying the shared directory on the remote server helps trace the resources targeted by the attacker. What is the name of the shared directory being accessed on the remote server?</strong>
            <p>Dans la ligne de commande Powershell, on peut observer le dossier dans lequel le dll se trouve.</p>
            <img src="Capture d'écran 2025-10-26 190819.png">
            <strong>Réponse : davwwwroot</strong>
            <hr>
            <strong>Question 5 : What is the MITRE ATT&CK sub-technique ID that describes the execution of a second-stage payload using a Windows utility to run the malicious file?</strong>
            <p>C'est une question sur laquelle j'ai un petit peu bloqué. Il faut juste en soi faire une recherche Google sur la technique mais je n'ai étrangement rien trouvé. J'ai donc mis l'adresse IP de l'attaquant sur VirusTotal, puis j'ai vu le nom du malware : STRELASTEALER. De là, j'ai pu regarder sa fiche sur MITRE ATT&CK et j'ai pu constater le sub id de la technique liée à rundll32.exe.</p>
            <img src="Capture d'écran 2025-10-26 191446.png">
            <img src="Capture d'écran 2025-10-26 191902.png">
            <img src="Capture d'écran 2025-10-26 191620.png">
            <strong>Réponse : T1218.011</strong>
            <hr>
            <strong>Question 6 : Identifying the username under which the malicious process runs helps in assessing the compromised account and its potential impact. What is the username that the malicious process runs under?</strong>
            <p>Bon... j'ai utilisé les indices... il fallait utiliser windows.getsids. J'ai ensuite regardé là où il y avait Powershell.exe. Il y avait un utilisateur : Elon</p>
            <img src="Capture d'écran 2025-10-26 192247.png">
            <strong>Réponse : Elon</strong>
            <hr>
            <strong>Knowing the name of the malware family is essential for correlating the attack with known threats and developing appropriate defenses. What is the name of the malware family?</strong>
            <p>Je l'avais vu auparavant : il s'agit de STRELASTEALER</p>
            <img src="Capture d'écran 2025-10-26 191902.png">
            <strong>Réponse : STRELASTEALER</strong>
            <hr>
            <p>Voilà, c'est la fin. C'est mon tout premier writeup sur la forensique mémoire. Je n'y suis pas très fort, mais on essaie d'avancer du mieux qu'on peut...</p>
        </div>
    </body>
</html>